FROM python:3.12-slim

WORKDIR /app

# Install uv
RUN pip install --no-cache-dir uv

# Copy project files for installation
COPY pyproject.toml /app/
COPY tron-ai/ /app/tron-ai/
COPY README.md /app/

# Install project in development mode using uv
RUN uv pip install --system -e .

# Copy the rest of the files
COPY . /app/

# Set environment variables
ENV PYTHONUNBUFFERED=1

# Entry script to read the config and start the appropriate MCP servers
COPY .docker/mcp/start_mcp.py /app/start_mcp.py

ENTRYPOINT ["python", "/app/start_mcp.py"]
